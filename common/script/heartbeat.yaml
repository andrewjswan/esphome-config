# ESPHome Heartbeat
id: publish_heartbeat
then:
  - mqtt.publish:
      topic: home/esphome/${device}/heartbeat
      payload: !lambda |-
        char str[20];
        time_t currTime = id(esp_time).now().timestamp;
        strftime(str, sizeof(str), "%Y-%m-%d %H:%M", localtime(&currTime));
        strcpy(id(sleep_heartbeat), str);
        return  { str };
      retain: true
